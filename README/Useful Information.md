# Contents Page
- ## [Useful Links](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#useful-links)
  - [Playwright .NET website](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#playwright-net-website-httpsplaywrightdevdotnet-)
  - [Playwright .NET docs](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#playwright-net-docs-httpsplaywrightdevdotnetdocsintro-)
  - [Guides](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#guides-click-the-top-left-button-to-view-guides-on-httpsplaywrightdevdotnetdocsintro-)
  - [Playwright .NET Application Programming Interface](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#playwright-net-application-programming-interface-httpsplaywrightdevdotnetdocsapiclass-playwright-)
  - [Online Demo of Playwright](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#online-demo-of-playwright)
    - [Demos](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#demos)
    - [Page screenshot](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#page-screenshot-this-code-snippet-navigates-to-the-playwright-github-repository-in-webkit-and-saves-a-screenshot)
    - [Generate PDF](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#generate-pdf-this-code-snippet-navigates-to-the-playwright-github-repository-and-generates-a-pdf-file-and-saves-it-to-disk)
    - [Request and response logging](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#request-and-response-logging-this-example-will-navigate-to-examplecom-and-log-all-its-request-methods-and-urls-and-for-the-response-the-status)
    - [Device emulation](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#device-emulation-this-example-emulates-a-pixel-2-and-creates-a-screenshot-with-its-screen-size)
- ## [Playwright Key Concepts](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#playwright-key-concepts)
    - [Playwright](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#playwright)
      - [Playwright Class Documentation](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#playwright-class-documentation)
      - [Example](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#playwright-module-provides-a-method-to-launch-a-browser-instance-the-following-is-a-typical-example-of-using-playwright-to-drive-automation)
    - [Browsers](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#browsers)
      - [Browsers Documentaion](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#browsers-documentaion)
      - [Browser Class Documentation](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#browser-class-documentation)
    - [Browser Contexts](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#browser-contexts)
      - [Browser Contexts Documentation](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#browser-contexts-documentation)
      - [Browser context class Documentation](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#browser-context-class-documentation)
    - [Pages](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#pages)
      - [Pages Documentation](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#pages-documentation)
      - [Page class Documentation](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#page-class-documentation)
    - [Page Object Model](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#page-object-model)
      - [Page Object Model Documentation](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#page-object-model-documentation)
- ## [Debugging](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#debugging-1)
  - [Error messages](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#error-messages)
  - [Common Script Errors](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#common-script-errors)
    - [Error - Element not found](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#error---element-not-found)
      - [Possible causes](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#possible-causes)
    - [Error - Click not executed](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#error---click-not-executed)
      - [Possible causes](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#possible-causes-1)
    - [Error - Element not visible](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#error---element-not-visible)
      - [Possible causes](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#possible-causes-2)
  
- ## [Debugging Tools](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#debugging-tools-1)
  - [Documentation](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#debugging-tools-playwright-documentation-httpsplaywrightdevdocsdebug)
  - [Run in Debug Mode](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#run-in-debug-mode)
  - [The Playwright Inspector](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#the-playwright-inspector)
  - [Run in headed mode](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#run-in-headed-mode)
  - [slowMo](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#slowmo)
  - [Page.PauseAsync()](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#pagepauseasync)
- ## [Best Practices](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#best-practices-1)
  - [Keeping tests valuable](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#keeping-tests-valuable)
    - [Keep tests short](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#keep-tests-short)
    - [Keep tests focused](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#keep-tests-focused)
  - [Choosing selectors](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#choosing-selectors)
    - [Attributes of a Good Selector](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#the-attributes-of-a-good-selector-are)
    - [Examples of (potentially) good selectors](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#examples-of-potentially-good-selectors)
    - [Examples of bad selectors](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#examples-of-bad-selectors)
- ## [Playwright Tools](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#playwright-tools-1)
  - [Generate code / selectors](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#generate-code--selectors)
  - [Run tests in debug mode](https://github.com/ASA-P/PlaywrightSynoptic/blob/main/README/Useful%20Information.md#run-tests-in-debug-mode)

# Useful Links
#### Playwright .NET website: https://playwright.dev/dotnet/ <br />
#### Playwright .NET docs: https://playwright.dev/dotnet/docs/intro <br />
#### Guides: Click the top left button to view guides on https://playwright.dev/dotnet/docs/intro <br />
![Image ](Images/TopLeftButton.png?raw=true)<br />
#### Playwright .NET Application Programming Interface: https://playwright.dev/dotnet/docs/api/class-playwright <br />
Click the top left button to view classes like the page class: https://playwright.dev/dotnet/docs/api/class-page
 
### Online Demo of Playwright 
#### [Demos:](https://try.playwright.tech/?l=csharp)
- #### [Page screenshot:](https://try.playwright.tech/?l=csharp&e=screenshot) This code snippet navigates to the Playwright GitHub repository in WebKit and saves a screenshot. 

- #### [Generate PDF:](https://try.playwright.tech/?l=csharp&e=generate-pdf) This code snippet navigates to the Playwright GitHub repository and generates a PDF file and saves it to disk. 

- #### [Request and response logging:](https://try.playwright.tech/?l=csharp&e=request-logging) This example will navigate to example.com and log all its request methods and URLs and for the response the status. 

- #### [Device emulation:](https://try.playwright.tech/?l=csharp&e=device-emulation) This example emulates a Pixel 2 and creates a screenshot with its screen size. 

# Playwright Key Concepts

## Playwright
- #### [Playwright Class Documentation](https://playwright.dev/dotnet/docs/api/class-playwright)
- #### Playwright module provides a method to launch a browser instance. The following is a typical example of using Playwright to drive automation:
```
using Microsoft.Playwright;
using System.Threading.Tasks;

class PlaywrightExample
{
    public static async Task Main()
    {
        using var playwright = await Playwright.CreateAsync();
        await using var browser = await playwright.Chromium.LaunchAsync();
        var page = await browser.NewPageAsync();

        await page.GotoAsync("https://www.microsoft.com");
        // other actions...
    }
}
```
## Browsers
- #### [Browsers Documentaion](https://playwright.dev/dotnet/docs/browsers)
- #### [Browser Class Documentation](https://playwright.dev/dotnet/docs/api/class-browser)

## Browser Contexts 
- #### [Browser Contexts Documentation](https://playwright.dev/dotnet/docs/)
- #### [Browser context class Documentation](https://playwright.dev/dotnet/docs/api/class-browsercontext)

- A BrowserContext is an isolated incognito-alike session within a browser instance. Browser contexts are fast and cheap to create. We recommend running each test scenario in its own new Browser context, so that the browser state is isolated between the tests.

## Pages
- #### [Pages Documentation](https://playwright.dev/dotnet/docs/pages)
- #### [Page class Documentation](https://playwright.dev/dotnet/docs/api/class-page)
- #### Each BrowserContext can have multiple pages. A Page refers to a single tab or a popup window within a browser context. It should be used to navigate to URLs and interact with the page content. Each browser context can host multiple pages (tabs):
    - Each page behaves like a focused, active page. Bringing the page to front is not required.
    - Pages inside a context respect context-level emulation, like viewport sizes, custom network routes or browser locale.

## Page Object Model

#### [Page Object Model Documentation](https://playwright.dev/dotnet/docs/pom)
- Large test suites can be structured to optimize ease of authoring and maintenance. Page object models are one such approach to structure your test suite.
- A page object represents a part of your web application. An e-commerce web application might have a home page, a listings page and a checkout page. Each of them can be represented by page object models.
Page objects simplify authoring. They create a higher-level API which suits your application.
Page objects simplify maintenance. They capture element selectors in one place and create reusable code to avoid repetition.

# Debugging 
Understanding why a script does not work as expected and finding the failure root cause are automation key skills.

Script debugging requires observation and understanding to find out what is causing the failure (or misbehaviour) in the execution:
1. What is the script supposed to do?                  
2. Check how the application the script is running against is supposed to behave at each step of the script.


### Error messages
When there is access to an error message, use it as a guide. (Error messages are not present in every scenario.) Error messages can require extra interpretation to understand what is going wrong with a script. Consider the script and app under test and question its meaning.
For example: an “Element not found” error might alert to an element not being found on the page, but that itself might be because the browser was made to load the wrong URL in the first place.


## Common Script Errors
### Error - Element not found
is a common message in automation scripts. Causes may be
wrong selectors, missing waits, navigation problems.
The obvious causes should be checked first.


#### **Possible causes**
- the selector is wrong.
- the element is not on the page and the automation tool is not automatically waiting for it to appear. An explicit wait might fix the problem.
- (Less obvious) The click on the previous element did not actually go through.
 From the perspective of Playwright, it was fine, but the script is looking for the right element but on the wrong page (or the page is in the wrong state), and the target element is therefore not found.


### Error - Click not executed

In certain situations, it might look as if no click is happening in the browser even if the script specifies it.

An example of Element not found error or similar: A Playwright script is supposed to run a ```page.click('#btn-login')``` but seems to ignore the click and just proceed with the next instruction. This can result in an ```Element not found error``` or similar.

#### **Possible causes**
- (Less obvious) The element trying to be clicked is on the page, but is not the one receiving the click; another element somewhere else on the page is receiving it instead. The instruction itself does not raise any error, as it is in fact being executed correctly.

#### **How to avoid confusion**
Try querying for the element in the browser console during inspection. If a ```document.querySelectorAll('mySelector') ```(or simply ```$$('mySelector')```) returns more than one element,  a more precise selector is needed, which references only the specific element to be clicked. 

If a selector is based on an ID, and a click is seemingly not going through, check whether the page contains duplicated IDs.


### Error - Element not visible

An element included in the DOM might not be properly interacting. 

#### **Possible causes**
-	Obvious cause: the element is wrongly set to hidden or something is wrong with the element itself.
-	Less obvious cause: a different element is unexpectedly hiding the target element.

#### **How to avoid confusion**
Remedy by a walk through the execution in headful mode or take screenshots before and after the instruction that has raised the error. This will help you verify whether the application state actually is the one you expect.

## Debugging Tools
#### **Debugging Tools Playwright Documentation:** https://playwright.dev/docs/debug

#### **Run in Debug Mode**
Set the PWDEBUG environment variable to run your scripts in debug mode. Using PWDEBUG=1 will open Playwright Inspector.

Using PWDEBUG=console will configure the browser for debugging in Developer tools console:

- Runs headed: Browsers always launch in headed mode
- Disables timeout: Sets default timeout to 0 (= no timeout)
- Console helper: Configures a playwright object in the browser to generate and highlight Playwright selectors. This can be used to verify text or composite selectors.
- - Allows you to step over code line by line

#### **The Playwright Inspector**
The Playwright Inspector is a GUI tool which exposes additional debugging functionality.

The Inspector allows easy step through each instruction of the script, giving  clear information on the duration, outcome, and functioning of each. This can be helpful in getting to the root cause of some of the more generic errors.

#### **Run in headed mode**
Playwright runs browsers in headless mode by default. 

#### **slowMo**
 You can also use the slowMo option to slow down execution and follow along while debugging.

https://playwright.dev/dotnet/docs/api/class-page#page-pause
Using a page.pause() method is an easy way to pause the Playwright script execution and inspect the page in Developer tools. It will also open Playwright Inspector to help with debugging.

#### **Page.PauseAsync()**
Pauses script execution. Playwright will stop executing the script and wait for the user to either press 'Resume' button in the page overlay or to call playwright.resume() in the DevTools console.

User can inspect selectors or perform manual steps while paused. Resume will continue running the original script from the place it was paused. This method requires Playwright to be started in a headed mode.

# Best Practices
## Keeping tests valuable

1. Tests should be reliable and informative in order to be useful.
2. Keep tests short and focused on testing one feature.
3. Keep tests independent to maximise their parallelisation potential and reduce total runtime.

### **Keep tests short**
Scripts will need to be regularly updated, if they run against a real-world product with a UI that is evolving over time. This brings up two important points:
1.	Most scripts are not write-and-forget, so each script written is one more script to be maintained.
2.	How the script is written can have a significant influence on how long this maintenance effort takes.

Scripts should strive for: 

1. #### **Simplicity:** focus on the goal of the script. Avoid overly complex solutions whenever possible.
2. #### **Conciseness:** keep scripts as short as they can be.
3. #### **Readability:** observe best practice around writing code that is easy to read.

The faster a script is understood, the quicker the results can be interpreted, allowing updates and keeping it relevant.

### **Keep tests focused**
Automated tests are effective if they:

1. Correctly verify the status of the target functionality.
2. Return within a reasonable amount of time.
3. Produce a result that can be easily interpreted by humans.

A script should make a test success or failure easy to spot to give a clear understanding of what is working and what is not.
Tests should not do too much. Combining tests that have part of their flow in common into a single test would obfuscate the meaning of a test failure as different features would be tested. If combined tests were to fail, it is hard to identify which feature failed. It is preferable to use tests that verify only one feature each. 
Check the assertions in the test. If spanning more than one feature, splitting the test into multiple tests is advised.

## Choosing selectors

The selectors in scripts will help determine how much maintenance work will be needed in the lifetime of a script. Aim to have robust selectors in place.

#### The attributes of a good selector are:

- **Uniqueness:** choose a selector that will identify the target element, and nothing else; **IDs** are the natural choice, when available.
- **Stability:** use an attribute that is unlikely to change as the page gets updated. (lowers the chances that you will need to manually update it.)
- **Conciseness:** prefer short selectors that are easier to read, understand and possibly replace if a script breaks.

### Examples of (potentially) good selectors


1. ```#elementId```
    - concise
    - unique, as long as the page contains **valid HTML**
    - generally stable
2. ```a[data-something=value]```
    - concise
    - unique, as long as ```value``` is
    - potentially stable, as long as ```value``` does not change very often
3. ```#overlay.close-button```
    - concise
    - unique, as long as only one element has class ```.close-button```
    - potentially stable, as long as ```.close-button``` does not change very often
4. ```div[@data-testid="cta"]```
    - concise
    - unique, as long as only one element has attribute ```data-testid``` equal to ```cta```
    - potentially stable, as long as ```data-testid``` is not changed often

### Examples of bad selectors
Avoid this kind of selector whenever possible:

1. ```.A8SBwf > .RNNXgb > .SDkEP > .a4bIc > .gLFyf```
  - not concise
  - likely not stable: class names are auto-generated, they could change rapidly
2. ```.g:nth-child(3) > .rc```
  - likely not stable: is the third child of ```.g``` always going to be present?
  - likely not unique: is it always going to be the right element?
3. ```a[data-v-9a19ef14]```
  - not stable: attribute is **auto-generated** and changes between deployments
  - likely not unique: is it always going to be the right element?
4. ```//div[1]/table[1]/tbody/tr[7]/td/a```
  - not concise
  - likely not stable: reliant on a precise page structure; extremely brittle
5. ```text=Continue```
  - likely not stable: the text might change for multiple reasons (restyling, localisation…)
  - likely not unique: is it always going to be the right element?

# Playwright Tools
### Generate code / selectors

Run codegen and perform actions in the browser. Playwright CLI will generate JavaScript code for the user interactions. codegen will attempt to generate resilient text-based selectors
Enter in Developer PowerShell:

```pwsh bin\Debug\netX\playwright.ps1 codegen```

### Run tests in debug mode
Enter in Developer PowerShell:
- Debug mode on:  ```$env:PWDEBUG=1```
- Off:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;```$env:PWDEBUG=0```
- Current value:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;```$env:PWDEBUG```